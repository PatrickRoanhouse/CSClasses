This is incomplete work. I've lost the finished code that was submited (careless rm -rf'ing).
